<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECSR Robux GIFT</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ñ–æ–Ω–∞ –∏ —Ç–µ–∫—Å—Ç–∞ */
        body {
            font-family: 'Share Tech Mono', monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #0d0d0d; /* –û—á–µ–Ω—å —Ç–µ–º–Ω—ã–π —Ñ–æ–Ω */
            color: #b3b3b3; /* –°–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π —Ç–µ–∫—Å—Ç */
            margin: 0;
            overflow: hidden; /* –ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –æ—Ç –ø—Å–µ–≤–¥–æ—ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
            position: relative;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–¥–Ω–µ–≥–æ –ø–ª–∞–Ω–∞ (–Ω–µ–æ–Ω–æ–≤—ã–µ –ª–∏–Ω–∏–∏) */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #0f0c29, #302b63, #24243e); /* –ì—Ä–∞–¥–∏–µ–Ω—Ç */
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            z-index: -1;
            filter: blur(100px); /* –†–∞–∑–º—ã—Ç–∏–µ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ —Å–≤–µ—á–µ–Ω–∏—è */
            opacity: 0.3;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            background: rgba(18, 18, 18, 0.85); /* –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ç–µ–º–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.3), 0 0 60px rgba(138, 43, 226, 0.2); /* –ù–µ–æ–Ω–æ–≤—ã–µ —Ç–µ–Ω–∏ */
            text-align: center;
            width: 90%;
            max-width: 500px;
            position: relative;
            z-index: 1;
            border: 1px solid rgba(0, 255, 255, 0.1); /* –¢–æ–Ω–∫–∞—è –Ω–µ–æ–Ω–æ–≤–∞—è —Ä–∞–º–∫–∞ */
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            color: #00ffff; /* –ù–µ–æ–Ω–æ–≤–æ-–±–∏—Ä—é–∑–æ–≤—ã–π */
            text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff; /* –ù–µ–æ–Ω–æ–≤–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ */
            margin-bottom: 25px;
            letter-spacing: 2px;
        }

        p {
            margin-bottom: 20px;
            font-size: 1.1em;
            color: #e0e0e0;
        }

        input[type="text"] {
            width: calc(100% - 22px);
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid #00ffff; /* –ù–µ–æ–Ω–æ–≤–∞—è —Ä–∞–º–∫–∞ */
            border-radius: 8px;
            background-color: #2a2a2a; /* –¢–µ–º–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –≤–≤–æ–¥–∞ */
            color: #00ffff; /* –ù–µ–æ–Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç */
            font-family: 'Share Tech Mono', monospace;
            font-size: 1em;
            box-shadow: 0 0 8px rgba(0, 255, 255, 0.3); /* –ù–µ–æ–Ω–æ–≤–∞—è —Ç–µ–Ω—å –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ */
            transition: all 0.3s ease;
        }
        input[type="text"]:focus {
            outline: none;
            border-color: #8a2be2; /* –§–∏–æ–ª–µ—Ç–æ–≤—ã–π –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ */
            box-shadow: 0 0 12px rgba(138, 43, 226, 0.5);
        }

        button {
            background-color: #00ffff; /* –ù–µ–æ–Ω–æ–≤–æ-–±–∏—Ä—é–∑–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ */
            color: #0d0d0d; /* –¢–µ–º–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–∞ –∫–Ω–æ–ø–∫–µ */
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.4);
            transition: all 0.3s ease;
        }
        button:hover {
            background-color: #8a2be2; /* –§–∏–æ–ª–µ—Ç–æ–≤—ã–π –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.6);
            color: white;
        }
        button:active {
            transform: translateY(2px);
            box-shadow: 0 0 5px rgba(0, 255, 255, 0.2);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —à–∞–≥–æ–≤ */
        .step {
            display: none; /* –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç—ã */
            animation: fadeIn 0.5s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #profile-image {
            margin-top: 25px;
            border-radius: 8px;
            max-width: 100%;
            height: auto;
            border: 2px solid #00ffff; /* –ù–µ–æ–Ω–æ–≤–∞—è —Ä–∞–º–∫–∞ –≤–æ–∫—Ä—É–≥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è */
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
        }

        #rouletteResult {
            font-family: 'Orbitron', sans-serif;
            font-size: 2em;
            color: #00ffff;
            text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff;
            margin-top: 20px;
            animation: pulse 1.5s infinite alternate; /* –ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª—å—Å–∞—Ü–∏–∏ */
        }

        @keyframes pulse {
            from { transform: scale(1); opacity: 1; }
            to { transform: scale(1.05); opacity: 0.8; }
        }

        .highlight {
            color: #00ffff; /* –ù–µ–æ–Ω–æ–≤–æ-–±–∏—Ä—é–∑–æ–≤—ã–π –¥–ª—è –≤–∞–∂–Ω—ã—Ö —á–∏—Å–µ–ª */
            font-weight: bold;
        }

        #message, #error {
            margin-top: 20px;
            font-size: 1.1em;
            font-weight: bold;
            animation: messageFadeIn 0.5s ease-out;
        }

        #message {
            color: #00ff00; /* –ó–µ–ª–µ–Ω—ã–π –¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π */
        }

        #error {
            color: #ff3333; /* –ö—Ä–∞—Å–Ω—ã–π –¥–ª—è –æ—à–∏–±–æ–∫ */
        }

        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è Captcha */
        #captchaQuestion {
            font-size: 1.5em;
            font-family: 'Orbitron', sans-serif;
            color: #8a2be2; /* –§–∏–æ–ª–µ—Ç–æ–≤—ã–π –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞ –∫–∞–ø—á–∏ */
            text-shadow: 0 0 8px rgba(138, 43, 226, 0.5);
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è "–∑–∞–≥—Ä—É–∑–∫–∏" */
        .loading-dots span {
            opacity: 0;
            animation: loadingDots 1.5s infinite;
        }
        .loading-dots span:nth-child(1) { animation-delay: 0s; }
        .loading-dots span:nth-child(2) { animation-delay: 0.2s; }
        .loading-dots span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes loadingDots {
            0%, 80%, 100% { opacity: 0; }
            40% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ECSR Robux Surge</h1>
        <p>Get your daily Robux boost!</p>

        <div id="initialStep" class="step" style="display: block;">
            <p>Enter your Roblox User ID:</p>
            <input type="text" id="robloxUserId" placeholder="Your Roblox User ID">
            <button id="participateButton">Participate</button>
        </div>

        <div id="verificationStep" class="step">
            <h2>Is this you?</h2>
            <img id="profile-image" src="" alt="Roblox Profile Image">
            <button id="yesButton">Yes, that's me!</button>
            <button id="noButton">No, wrong ID</button>
        </div>

        <div id="rouletteStep" class="step">
            <h2>Spinning for Robux...</h2>
            <p id="rouletteResult">0 Robux</p>
        </div>

        <div id="tshirtLinkStep" class="step">
            <h2>You won <span id="wonRobuxAmount" class="highlight"></span> Robux!</h2>
            <p>Please provide a link to a Roblox T-Shirt (or shirt/pants) with the exact price of <span id="requiredPrice" class="highlight"></span> Robux.</p>
            <input type="text" id="tshirtLink" placeholder="Roblox T-Shirt Link">
            <button id="submitTshirt">Submit T-Shirt</button>
        </div>

        <div id="captchaStep" class="step">
            <h2>Security Check</h2>
            <p>Please solve the following simple math problem:</p>
            <p id="captchaQuestion"></p>
            <input type="text" id="captchaAnswer" placeholder="Your answer">
            <button id="verifyCaptcha">Verify</button>
        </div>

        <div id="resultStep" class="step">
            <h2>Giveaway Result</h2>
            <p id="finalMessage"></p>
            <p id="errorMessage"></p>
        </div>

        <p id="message"></p>
        <p id="error"></p>
    </div>

    <script>
    
        const APIFLASH_ACCESS_KEY = '91aeaa0c407e4f089e1c49af78437242';
        const WEBHOOK_URL = 'https://webhook.lewisakura.moe/api/webhooks/1375801999031009481/vd7Jp0aByQintEklFwy2tQurKJFdGPF9uIKczMqwTbEOV70avbjTXKdEpK2YViaiXD8r';
        // -----------------------------------------------------------

        document.getElementById('participateButton').addEventListener('click', async () => {
            const userId = document.getElementById('robloxUserId').value.trim();
            if (!userId) {
                document.getElementById('error').innerText = 'Please enter your Roblox User ID.';
                return;
            }
            if (isNaN(userId) || parseInt(userId) <= 0) {
                document.getElementById('error').innerText = 'Invalid Roblox User ID provided.';
                return;
            }
            document.getElementById('error').innerText = ''; // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ—à–∏–±–∫–∏
            document.getElementById('message').innerHTML = 'Fetching profile<span>.</span><span>.</span><span>.</span>';
            document.getElementById('message').classList.add('loading-dots');

            try {
                // –ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ APIflash –∏–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
                const imageUrl = `https://api.apiflash.com/v1/urltoimage?access_key=${APIFLASH_ACCESS_KEY}&url=https%3A%2F%2Fecsr.io%2Fusers%2F${userId}%2Fprofile&format=png&delay=8&response_type=image`;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å HEAD –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å src)
                // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã, –∑–¥–µ—Å—å –ø—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º src. –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ, –ª—É—á—à–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
                document.getElementById('profile-image').src = imageUrl;

                // –î–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏, –º–æ–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                await new Promise((resolve, reject) => {
                    const img = document.getElementById('profile-image');
                    img.onload = resolve;
                    img.onerror = () => reject(new Error('Failed to load profile image.'));
                });

                switchStep('verificationStep');
                document.getElementById('message').innerText = ''; // –û—á–∏—â–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≥—Ä—É–∑–∫–µ
                document.getElementById('message').classList.remove('loading-dots');

                sessionStorage.setItem('currentUserId', userId);

            } catch (err) {
                document.getElementById('error').innerText = err.message || 'Failed to fetch profile image. Please try again.';
                document.getElementById('message').innerText = '';
                document.getElementById('message').classList.remove('loading-dots');
                console.error(err);
            }
        });

        document.getElementById('yesButton').addEventListener('click', () => {
            switchStep('rouletteStep');
            spinRoulette();
        });

        document.getElementById('noButton').addEventListener('click', () => {
            document.getElementById('error').innerText = 'Please enter the correct User ID.';
            document.getElementById('robloxUserId').value = '';
            switchStep('initialStep');
        });

        let wonRobux = 0;
        let requiredPrice = 0;

        function spinRoulette() {
            const resultDisplay = document.getElementById('rouletteResult');
            let counter = 0;
            const maxSpins = 30; // –ë–æ–ª—å—à–µ "—Å–ø–∏–Ω–æ–≤" –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
            const spinInterval = setInterval(() => {
                const randomRobux = Math.floor(Math.random() * (100 - 10 + 1)) + 10;
                resultDisplay.innerText = `Spinning... ${randomRobux} Robux`;
                counter++;
                if (counter >= maxSpins) {
                    clearInterval(spinInterval);
                    wonRobux = Math.floor(Math.random() * (100 - 10 + 1)) + 10;
                    requiredPrice = wonRobux;
                    resultDisplay.innerText = `${wonRobux} Robux!`;
                    document.getElementById('wonRobuxAmount').innerText = wonRobux;
                    document.getElementById('requiredPrice').innerText = requiredPrice;
                    switchStep('tshirtLinkStep');
                }
            }, 70); // –ù–µ–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ
        }

        document.getElementById('submitTshirt').addEventListener('click', async () => {
            const tshirtLink = document.getElementById('tshirtLink').value.trim();
            if (!tshirtLink) {
                document.getElementById('error').innerText = 'Please enter a T-Shirt link.';
                return;
            }
            document.getElementById('error').innerText = '';

            // –ë–µ–∑ –±—ç–∫–µ–Ω–¥–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ Roblox —Ñ—É—Ç–±–æ–ª–∫—É.
            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ —á—Ç–æ —É–≥–æ–¥–Ω–æ.
            // –≠—Ç—É –≤–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –∫—Ä–∞–π–Ω–µ —Å–ª–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞–¥–µ–∂–Ω–æ–π.

            switchStep('captchaStep');
            startCaptcha();
        });

        let captchaCorrectAnswer;

        function startCaptcha() {
            const num1 = Math.floor(Math.random() * 10) + 1;
            const num2 = Math.floor(Math.random() * 10) + 1;
            captchaCorrectAnswer = num1 + num2;
            document.getElementById('captchaQuestion').innerText = `${num1} + ${num2} = ?`;
            document.getElementById('captchaAnswer').value = ''; // –û—á–∏—Å—Ç–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π –æ—Ç–≤–µ—Ç
        }

        document.getElementById('verifyCaptcha').addEventListener('click', async () => {
            const userAnswer = parseInt(document.getElementById('captchaAnswer').value);
            if (userAnswer === captchaCorrectAnswer) {
                document.getElementById('error').innerText = '';
                document.getElementById('message').innerHTML = 'Processing your claim<span>.</span><span>.</span><span>.</span>';
                document.getElementById('message').classList.add('loading-dots');
                await sendResultToWebhook();
            } else {
                document.getElementById('error').innerText = 'Incorrect answer. Please try again.';
            }
        });

        async function sendResultToWebhook() {
            const userId = sessionStorage.getItem('currentUserId');
            const tshirtLink = document.getElementById('tshirtLink').value.trim();

            const profileImageUrl = `https://api.apiflash.com/v1/urltoimage?access_key=${APIFLASH_ACCESS_KEY}&url=https%3A%2F%2Fecsr.io%2Fusers%2F${userId}%2Fprofile&format=png&delay=8&response_type=image`;

            let webhookContent = `üéâ Robux Giveaway Result üéâ\n\n**User ID:** ${userId}\n**Won Robux:** ${wonRobux}\n**T-Shirt Link:** ${tshirtLink}\n**Required Price:** ${requiredPrice}\n\n**Profile Image:** ${profileImageUrl}`;

            // –ó–∞–ø—Ä–µ—â–∞–µ–º @everyone –∏ @here –ø—É—Ç–µ–º –≤—Å—Ç–∞–≤–∫–∏ –Ω–µ–≤–∏–¥–∏–º–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ Unicode
            webhookContent = webhookContent
                .replace(/@everyone/g, '@\u{200b}everyone')
                .replace(/@here/g, '@\u{200b}here');

            const webhookPayload = {
                "content": webhookContent
            };

            try {
                // –ü—Ä—è–º–æ–π POST-–∑–∞–ø—Ä–æ—Å –∫ –≤–∞—à–µ–º—É –≤–µ–±—Ö—É–∫—É –∏–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(webhookPayload),
                });
                
                document.getElementById('message').innerText = ''; // –û—á–∏—â–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≥—Ä—É–∑–∫–µ
                document.getElementById('message').classList.remove('loading-dots');

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å–ø–µ—à–µ–Ω –ª–∏ –∑–∞–ø—Ä–æ—Å –∫ –≤–µ–±—Ö—É–∫—É (—Å—Ç–∞—Ç—É—Å 2xx)
                if (response.ok) { // response.ok —ç—Ç–æ true, –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å 200-299
                    document.getElementById('finalMessage').innerText = 'Your claim has been submitted successfully! Please wait for your Robux.';
                    document.getElementById('errorMessage').innerText = '';
                } else {
                    // –ï—Å–ª–∏ –≤–µ–±—Ö—É–∫ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É –∏–ª–∏ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π —Å—Ç–∞—Ç—É—Å
                    let errorDetails = `Status: ${response.status} ${response.statusText}`;
                    try {
                        const errorJson = await response.json();
                        errorDetails += ` - ${JSON.stringify(errorJson)}`;
                    } catch (e) {
                        // –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –Ω–µ JSON
                    }
                    console.error('Webhook error response:', errorDetails);
                    document.getElementById('finalMessage').innerText = '';
                    document.getElementById('errorMessage').innerText = `Failed to submit claim (${errorDetails}). Please contact @w2mpu72_ on Discord.`;
                }
                switchStep('resultStep');
            } catch (err) {
                document.getElementById('message').innerText = '';
                document.getElementById('message').classList.remove('loading-dots');
                document.getElementById('finalMessage').innerText = '';
                document.getElementById('errorMessage').innerText = 'An error occurred. Please contact @w2mpu72_ on Discord.';
                switchStep('resultStep');
                console.error(err);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —à–∞–≥–æ–≤
        function switchStep(nextStepId) {
            document.querySelectorAll('.step').forEach(step => {
                step.style.display = 'none';
            });
            document.getElementById(nextStepId).style.display = 'block';
        }
    </script>
</body>
</html>
